#!/bin/sh
# Updates GeoGebra from SVN repository
# @author Zoltan Kovacs <zoltan@geogebra.org>

test -r autobuild.conf || {
 echo "Cannot find autobuild.conf (make sure you edit autobuild.conf.dist first)"
 exit 1
 }
. ./autobuild.conf
cd $SVNDIR/geogebra

if [ "$1" != "--no-update" ]; then
    svn update --accept theirs-full | tail -1 | grep ^At && exit 0 # No updates found.
    fi

export JAVA_HOME
export ANT_OPTS="-Xmx1024m"

# alias signjar=jarsigner # May be needed for ant version < 1.8.0 (the "executable" attribute is not supported yet).

ant -f build.xml geogebra-cl
cd build
mkdir -p $WWWDIR

# Copying dynamically generated files (autobuild):
cp -R * $WWWDIR

# Copying static files:
cp -R $SVNDIR/geogebra/webstart/4.0 $WWWDIR
